#!/bin/bash
# HecateOS System Information Tool

VERSION="24.04 LTS"
CODENAME="Crossroads"
BUILD_DATE="2024.01.22"

# Colors
PURPLE='\033[0;35m'
CYAN='\033[0;36m'
GREEN='\033[0;32m'
YELLOW='\033[1;33m'
WHITE='\033[1;37m'
RESET='\033[0m'

show_logo() {
    echo -e "${PURPLE}"
    cat << 'EOF'
    ╦ ╦┌─┐┌─┐┌─┐┌┬┐┌─┐╔═╗╔═╗
    ╠═╣├┤ │  ├─┤ │ ├┤ ║ ║╚═╗
    ╩ ╩└─┘└─┘┴ ┴ ┴ └─┘╚═╝╚═╝
EOF
    echo -e "${RESET}"
}

show_info() {
    echo -e "${WHITE}HecateOS System Information${RESET}"
    echo -e "${WHITE}━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━${RESET}"
    echo -e "Version:     ${CYAN}$VERSION ($CODENAME)${RESET}"
    echo -e "Build Date:  ${CYAN}$BUILD_DATE${RESET}"
    echo -e "Base:        ${CYAN}Ubuntu 24.04 LTS${RESET}"
    echo -e "Kernel:      ${CYAN}$(uname -r)${RESET}"
    echo -e "Architecture: ${CYAN}$(uname -m)${RESET}"
    echo ""
    echo -e "${WHITE}System Optimizations:${RESET}"
    echo -e "  ${GREEN}✓${RESET} Performance-tuned kernel"
    echo -e "  ${GREEN}✓${RESET} NVIDIA RTX optimizations"
    echo -e "  ${GREEN}✓${RESET} ZRAM compression enabled"
    echo -e "  ${GREEN}✓${RESET} CPU mitigations disabled"
    echo -e "  ${GREEN}✓${RESET} I/O scheduler optimized"
    echo ""
}

show_hardware() {
    echo -e "${WHITE}Hardware Configuration:${RESET}"
    echo -e "${WHITE}━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━${RESET}"
    
    # CPU
    CPU_MODEL=$(lscpu | grep "Model name" | cut -d: -f2 | xargs)
    CPU_CORES=$(lscpu | grep "^CPU(s):" | cut -d: -f2 | xargs)
    echo -e "CPU:     ${CYAN}$CPU_MODEL${RESET}"
    echo -e "Cores:   ${CYAN}$CPU_CORES${RESET}"
    
    # Memory
    MEM_TOTAL=$(free -h | grep Mem | awk '{print $2}')
    echo -e "Memory:  ${CYAN}$MEM_TOTAL${RESET}"
    
    # GPU
    if command -v nvidia-smi &> /dev/null; then
        GPU_MODEL=$(nvidia-smi --query-gpu=name --format=csv,noheader 2>/dev/null)
        GPU_DRIVER=$(nvidia-smi --query-gpu=driver_version --format=csv,noheader 2>/dev/null)
        echo -e "GPU:     ${CYAN}$GPU_MODEL${RESET}"
        echo -e "Driver:  ${CYAN}$GPU_DRIVER${RESET}"
    fi
    
    # Storage
    echo -e "\n${WHITE}Storage Devices:${RESET}"
    lsblk -d -o NAME,SIZE,TYPE,MODEL | grep -E "nvme|sd"
    echo ""
}

show_performance() {
    echo -e "${WHITE}Performance Status:${RESET}"
    echo -e "${WHITE}━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━${RESET}"
    
    # CPU Governor
    if [ -f /sys/devices/system/cpu/cpu0/cpufreq/scaling_governor ]; then
        GOVERNOR=$(cat /sys/devices/system/cpu/cpu0/cpufreq/scaling_governor)
        echo -e "CPU Governor:    ${CYAN}$GOVERNOR${RESET}"
    fi
    
    # Tuned Profile
    if command -v tuned-adm &> /dev/null; then
        TUNED_PROFILE=$(tuned-adm active 2>/dev/null | grep -oP 'Current active profile: \K.*')
        echo -e "Tuned Profile:   ${CYAN}$TUNED_PROFILE${RESET}"
    fi
    
    # ZRAM Status
    if [ -b /dev/zram0 ]; then
        ZRAM_SIZE=$(zramctl --raw --bytes --noheadings /dev/zram0 2>/dev/null | awk '{print $3/1024/1024/1024 " GB"}')
        echo -e "ZRAM Swap:       ${CYAN}$ZRAM_SIZE${RESET}"
    fi
    
    # System Load
    LOAD=$(uptime | awk -F'load average:' '{print $2}')
    echo -e "Load Average:   ${CYAN}$LOAD${RESET}"
    echo ""
}

case "$1" in
    --version|-v)
        echo "HecateOS $VERSION ($CODENAME)"
        ;;
    --hardware|-h)
        show_logo
        show_hardware
        ;;
    --performance|-p)
        show_logo
        show_performance
        ;;
    --all|-a)
        show_logo
        show_info
        show_hardware
        show_performance
        ;;
    *)
        show_logo
        show_info
        echo "Usage: hecate-info [OPTIONS]"
        echo "  --version, -v     Show version"
        echo "  --hardware, -h    Show hardware info"
        echo "  --performance, -p Show performance status"
        echo "  --all, -a        Show all information"
        ;;
esac